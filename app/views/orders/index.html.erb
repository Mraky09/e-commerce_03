<% provide :title, t(".my_purchase") %>

<h1><%= t ".my_purchase" %></h1>

<%= search_form_for @search do |f| %>
  <div class="col-md-4 col-md-offset-3 row">
    <%= f.search_field :id_eq, class: "form-control", placeholder: t(".search_order_user") %>
  </div>
  <div class="col-md-2 row">
    <%= f.submit t("search"), class: "btn btn-primary" %>
  </div>
<% end %>

<table class="table table-hover table-striped user-view-purchase-history">
  <thead>
    <tr>
      <th><%= t "table_index" %></th>
      <th><%= t ".order_code" %></th>
      <th><%= t ".created_at" %></th>
      <th><%= t ".grand_total" %></th>
      <th><%= t ".products_quantity" %></th>
      <th><%= t ".shipping_address" %></th>
      <th><%= t ".status" %></th>
    </tr>
  </thead>
  <tbody>
    <% if @orders.any? %>
      <% @orders.each_with_index do |order, index| %>
        <tr>
          <td>
            <% params[:page] ||= "1" %>
            <%= create_index params[:page], index, Settings.user.orders_history.per_page %>
          </td>
          <td><%= order.id %></td>
          <td><%= l order.created_at, format: :long %></td>
          <td><%= number_to_currency order.total_money %></td>
          <td>
            <%= order.order_details.group("order_id").sum(:quantity).first[1] %>
          </td>
          <td><%= order.shipping_address %></td>
          <td class="no-data">
            <span class="order-<%= order.status %>"><%= order.status %></span>
          </td>
        </tr>
      <% end %>
    <% else %>
      <tr><td colspan="7" class="no-data"><%= t "no_data" %></td></tr>
    <% end %>
  </tbody>
</table>

<%= paginate @orders, theme: "twitter-bootstrap-4" %>
